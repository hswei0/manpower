spread(1,2) %>%
select(5, 2, 1, 4, 6, 3) # 調整倆倆相對順序
} else {
b <- a %>%
slice(-c(1:10)) %>%
select(16, 15) %>% # 選取平均月薪，用英文當標籤
slice(c(11, 12, 14, 15, 25,26)) %>% # 選取產業
spread(1,2) %>%
select(5, 2, 1, 4, 6, 3) # 調整倆倆相對順序
}
b[["year"]] <- year
names(b) <- paste0("x", 1:length(b))
return(b)
}
c <- map_df(j, eachworktype.fn)
return(c)
}
# Bind Data
age.df <- making_age("Age")
industry.df <- making_indusrty("Industry")
worktype.df <- making_worktype("Worktype")
# Naming ------------------------------------------------------------------
naming.fn <- function(i){
agelab.en <- c("15-24 years", "25-44 years", "45-64 years", "65 years & over", "year")
agelab.chi <- c("１５-２４歲", "２５-４４歲", "４５-６４歲", "６５歲及以上", "年份")
industrylab.en <- c(
"Agriculture, Forestry, Fishing & Animal Husbandry",
"Goods-Producing Industries",
"Services-Producing Industries", "year")
industrylab.chi <- c("農、林、漁、牧業", "工業", "服務業", "年份")
worktypelab.en <- c(
"Part-time, temporary or dispatched workers",
"Non part-time, temporary or dispatched workers",
"Full-time workers",
"Part-time workers",
"Temporary or dispatched workers",
"Non temporary or dispatched workers", "year")
worktypelab.chi <- c(
"部分時間、臨時性或人力派遣工作", "非部分時間、臨時性或人力派遣工作",
"全日時間工作", "部分時間工作",
"臨時性或人力派遣工作", "非臨時性或人力派遣工作", "年份")
if (i == "English"){
names(age.df) <- agelab.en
names(industry.df) <- industrylab.en
names(worktype.df) <- worktypelab.en
b <- bind_cols(age.df, industry.df, worktype.df) %>%
select(year, everything(), -c(year1, year2))
}else {
names(age.df) <- agelab.chi
names(industry.df) <- industrylab.chi
names(worktype.df) <- worktypelab.chi
b <- bind_cols(age.df, industry.df, worktype.df)%>%
select(年份, everything(), -c(年份1, 年份2))
}
return(b)
}
alldf.en <- naming.fn("English")
alldf.chi <- naming.fn("Chinese")
write_excel_csv(alldf.chi, "/Users/hsuwei/Desktop/manpower/result/manpower.xlsx")
# 繪圖 ----------------------------------------------------------------------
library(tidyverse)
library(magrittr)
## age specific
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +geom_line()
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, group = type)) +geom_line()
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income)) +geom_line()
, group = type
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, group = type)) +geom_line()
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +geom_line()
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 2)
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1.5)
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1.5) +
scale_x_continuous(limits = c(20000, 50000))
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks=seq(0, 10, 5))
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks=seq(0, 10, 20))
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks=seq(0, 10,100))
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1.5) +
scale_y_log10()
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1.5) +
scale_y_continuous(breaks = c(15000, 25000, 35000, 45000))
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1.5) +
scale_y_continuous(breaks = c(15000, 35000, 45000))
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1.5) +
scale_y_log10()
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1.5)
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1.5) +
labs(title = "Age-Specific Income")
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1.5) +
labs(title = "Age-Specific Income", caption = "Age Group")
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) + labs(title = "Age-Specific Income") +
grid.arrange(Line,(Line +scale_colour_Publication()+ theme_Publication()),nrow=1)
library(gridExtra)
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) + labs(title = "Age-Specific Income") +
grid.arrange(Line,(Line +scale_colour_Publication()+ theme_Publication()),nrow=1)
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) + labs(title = "Age-Specific Income") %>%
grid.arrange(.,(. +scale_colour_Publication()+ theme_Publication()),nrow=1)
library(scales)
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) + labs(title = "Age-Specific Income") %>%
grid.arrange(.,(. + scale_colour_Publication() + theme_Publication()),nrow=1)
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
theme_Publication <- function(base_size=14, base_family="helvetica") {
library(grid)
library(ggthemes)
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.2, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
scale_fill_Publication <- function(...){
library(scales)
discrete_scale("fill","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) + labs(title = "Age-Specific Income") %>%
grid.arrange(.,(. + scale_colour_Publication() + theme_Publication()),nrow=1)
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) +
theme_economist() +
scale_colour_economist() +
ggtitle("Age-Specific Income")
library(ggthemes)
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) +
theme_economist() +
scale_colour_economist() +
ggtitle("Age-Specific Income")
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) +
+ theme_solarized() + scale_colour_solarized("blue")) +
ggtitle("Age-Specific Income")
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) +
+ theme_solarized() + scale_colour_solarized("blue")) +
ggtitle("Age-Specific Income")
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) +
+ theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Age-Specific Income")
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3)
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) + theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Age-Specific Income")
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) + theme_wsj()
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.3) + theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Age-Specific Income")
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1.2) + theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Age-Specific Income")
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1) + theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Age-Specific Income")
alldf.en %>%
select(1, 6:8) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) + geom_line() +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Industry-specific Income")
alldf.en %>%
select(1, 6:8) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Industry-specific Income")
alldf.en %>%
select(1, 9:14) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income")
par(mfrow=c(3,1))
alldf.en %>%
select(1, 9:10) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income1")
alldf.en %>%
select(1, 11:12) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income2")
alldf.en %>%
select(1, 13:14) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income3")
par(mfrow=c(3,1))
alldf.en %>%
select(1, 9:10) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income1")
alldf.en %>%
select(1, 11:12) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income2")
alldf.en %>%
select(1, 13:14) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income3")
par(mfrow=c(1,3))
alldf.en %>%
select(1, 9:10) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income1")
alldf.en %>%
select(1, 11:12) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income2")
alldf.en %>%
select(1, 13:14) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income3")
par(mfrow=c(1,3))
alldf.en %>%
select(1, 9:10) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income1")
alldf.en %>%
select(1, 11:12) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income2")
alldf.en %>%
select(1, 13:14) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income3")
save(alldf.en, alldf.chi, file = "/Users/hsuwei/Desktop/manpower/result/manpower.RData")
load("/Users/hsuwei/Desktop/manpower/result/manpower.RData")
library(tidyverse)
library(magrittr)
library(gridExtra)
library(ggthemes)
## age specific
alldf.en %>%
select(1:5) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size=1) + theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Age-Specific Income")
## industry specific
alldf.en %>%
select(1, 6:8) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Industry-specific Income")
## worktype specific
par(mfrow=c(1,3))
alldf.en %>%
select(1, 9:10) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income1")
alldf.en %>%
select(1, 11:12) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income2")
alldf.en %>%
select(1, 13:14) %>%
gather("type", "income", -year) %>%
mutate_at(c("year", "income"), as.numeric) %>%
ggplot(data = ., mapping = aes(x = year, y = income, color = type)) +
geom_line(size = 1) +
theme_solarized() + scale_colour_solarized("blue") +
ggtitle("Worktype-Specific Income3")
alldf.en
knitr::kable(alldf.en)
